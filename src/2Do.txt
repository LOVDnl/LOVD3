Prioritize:
===========
- (@Ivo) genes?authorize : Gebruikers mogen geen gelijke users rechten ontnemen. Bouw die check in op query niveau.
- (@Ivo) Ga naar viewlist, hersorteer, zoek, hersorteer. Terug kun je wel door sort, maar niet de undo van het zoeken.
- (BELANGRIJK) Testen wat public / curator wel en niet mag.
  * Ook als knopjes niet zichtbaar zijn, of de pagina zelf 'm ook blokkeert.
  * Eerst moet er code geschreven worden die de authorisatie van de gebruiker goed detecteert!
    - Mist nog voor patients, phenotypes, screenings. Check variants code nog.
    - Curators mogen een patient en aangehangen info pas bekijken als hij een screening aan hun gen heeft.
    - Curatoren mogen in principe alleen de varianten aanpassen, geen patient data of phenotype data. Tenzij ze de owner of created_by zijn, natuurlijk.
      * Over dit laatste een stemronde houden binnen de gebruikers?
- (BELANGRIJK) Cols instelling public_add, public_view moet gerespecteerd worden!!!!!!
  * objects_custom moet alle kolommen laden; functies die de data opbouwen voor viewForm, viewEntry, getForm, checkFields etc moeten dan de juiste flags controleren.
- (~~~~~~BELANGRIJK: Ivar) TranscriptVariant: add, edit, delete (gekoppeld aan GenomeVariant!)
- (BELANGRIJK) Alle links nalopen, of ze werken.
- (BELANGRIJK: Ivo) Pathogenicity?
- (~BELANGRIJK) Submissie: = alles aan elkaar knopen
- (~BELANGRIJK: Ivo) Icoontjes voor setup???
- (~BELANGRIJK) Misschien beter een inc-js-lib-init.php o.i.d. te maken, omdat we nu al openWindow en toggleVisibility hebben, en dat zijn al twee JS calls. Vertraagt LOVD.
- Nu genes gewoon openbaar is, is status.php niet meer echt nodig - maar hij is wel enorm traag op een grote installatie.
  * Zorg er voor dat de info die uit status.php gehaald kan worden m.b.t. de genen, ook in de genes viewList terecht komen.
  * Status.php kan dan andere gegevens gaan geven, niet meer per gen. Heb je suggesties?
- Er mogen geen 2.0 opmerkingen meer in LOVD 3.0 staan.
- Check alle viewLists, iedere viewList *moet* een anchor hebben op de belangrijkste kolom (=degene die praktisch nooit verborgen zal worden).
- Gene selection lists zijn veel te groot als je een database hebt met lange gen namen. LOVD 2.0 had daar een techniek voor, om dat in te korten.
- BUG: Ik maak screening aan, gekoppeld aan individu. Mag niet selecteren welk gen ik gescreend heb.
- BUG: Kan een variant niet aan een screening koppelen, ook al gebruik ik de juiste link er voor.
- Kijk 'ns naar https://grenada.lumc.nl/LOVD3/shared, er zit een individu in met een aantal mutaties. Kun je makkelijk naar al zijn data navigeren?
  * We missen veel links tussen data in. Onder variants on genome zou een variants_on_transcript viewList moeten, en ik moet naar de screening en individu kunnen vanuit daar. Dat soort dingen.
- Was 't nou geregeld, dat inc-upgrade.php een curator koos voor genen zonder curator?
- Objects::viewList() heeft sinds kort code voor het invullen van $zData['row_id'] en aanverwanten. De prepareData() functies kunnen daarom ingekort worden.
- (@Ivar) Er is in #57 code verwijderd uit objects_custom die checkt dat shared objects een objectID moeten hebben ontvangen. Die check is toch nog steeds nodig?
- Adding phenotype button should not appear if individual does not have a disease associated.
- If only one disease: auto select that disease for phenotype add?
- Adding phenotype: diseaseid in GET, zodat we er direct naar zouden kunnen linken. Scheelt ook gedoe in getForm() van phenotype.
- Adding phenotype should not be possible if no columns have been enabled yet.
  * When disease is created, forward user to select columns for this disease.
- (@Ivar) BUG: Non-shared columns can't be removed.
  * Ivar, ik heb deze bug volgens mij opgelost, maar kijk er voor de zekerheid nog even naar (Ivo).
  * (@Ivo) Schoon deze code op, nadat Ivar gecommit heeft.
- (@Ivar) BUG: Maak phenotype aan, selecteer geen disease, submit form. Kijk nog eens goed naar transcripts?create en zorg er voor dat alle controles goed staan!!!
- Gene create: diseases van OMIM mirror van LOVD.nl ophalen?
- Veranderingen zoals besloten 2011-06-28
  * Variant/Times_reported / chromosomes_found o.i.d.?
- (@Ivar) BUG: Gene mag niet een al gekozen symbol hebben, check ook in stap 2!
- Veranderingen zoals voorgesteld 2011-06-28?
  * Allele, genetic_origin, Phenotype/Inheritance
    - Current plans:
        Variant/Allele:
        -unknown
        -paternal (confirmed)
        -paternal (inferred)
        -maternal (confirmed)
        -maternal (inferred)
        -parent #1
        -parent #2
        -both (homozygous) (there is still discussion about this)

        Variant/Genetic_Origin
        -unknown
        -inherited
        -de novo
        -de novo, germline
        -de novo, somatic
        -uniparental disomy
        -uniparental disomy, maternal allele
        -uniparental disomy, paternal allele
        -in vitro (cloned)
        -non-human (model organism)

        Phenotype/Inheritance
        -familial
        -familial, autosomal dominant
        -familial, autosomal recessive
        -familial, autosomal recessive, consanguineous
        -familial, X-linked
        -sporadic
        -sporadic, parents consanguineous
        -sporadic, parents not consanguineous
        -sporadic, consanguinity unknown

    - Probleem: recombination? inherited from mother (moeder heeft 't) maar recombined to allele from father - hoe opslaan?
- (@Ivar) Phenotype entries moeten ook statusid hebben!



- Ensemble gene ID opslaan en leiden naar: http://www.ensembl.org/Homo_sapiens/Gene/Summary?g=ENSG00000073734
- "Individual has been screened, no variants have been found"
  - That means we need an additional column!!!!!!!!
- Menu inbouwen, zodat "create" pagina's beschikbaar komen!
  * Of tijdelijke andere oplossing.
- (Ivo) Check column breedte; wordt dat berekend of moet er iets worden ingevuld? Minimale waarden?
- (Later) Versioned tabel structuur aanpassen zoals nieuwe stresstest aantoonde dat beter was.
  * Twee tabellen, normale en _revisions. Versioned tabel heeft datum kolommen zoals, nu, MAAR GEEN created_by, created_date.
  * Probleem: als wij de created_* data in de niet-versioned tabel hebben, MOETEN WE DIE ENTRY BEWAREN BIJ DELETION!!!
- (Ivar) Diseases: zit er een check op, dat er maar 1 OMIM ID mag worden aangemaakt? Code level?
- (Ivo) /genes/GENE?authorize en/of /genes/GENE?sortCurators
      Het verschil tussen ?authorize en ?sortCurators moet nog gemaakt worden. De laatste moet beschikbaar zijn voor curators.
- Raar: /genes/DMD?authorize -> click alle users aan -> resort viewList.
- loadEntry() en viewEntry() kolommen automatisch laten exploden op basis van hun naam; gc_NAME = array (;) of gc2_NAME = nested array (;;).
- Use uniqid ipv lovd functie?
- Deinstalleren moet gewoon altijd werken. Als de foutmelding "foreign key constraint fails" opduikt bij het removen, moet LOVD gewoon opnieuw proberen of misschien in een andere (random??) volgorde of misschien de tabel die de fout triggered achteraan zetten en opnieuw proberen.
- Insert_test_data.php moet of goed getest worden, of weggeflikkerd worden. Ik heb alleen genes, transcripts en diseases na het runnen daarvan, maar geen errors op mijn scherm gezien.
- (Ivo:??) Melding van viewList() dat er geen resultaten zijn, moet binnen de normale DIV, zodat de viewList() te herladen is. Zie FIXME bij genes/GENE?authorize.
- Zoek op row_id en row_link in prepareData() calls, die zullen hopelijk nergens meer nodig zijn (viewList() genereert ze nu zelf).
- (@Ivo) BUG;
    /check_update?icon returned error in code block Unknown.
    Query : SELECT g.id, g.name, g.updated_date, GROUP_CONCAT(DISTINCT u2g.userid ORDER BY u2g.show_order) AS users, GROUP_CONCAT(DISTINCT d.id ORDER BY d.name) AS diseases FROM lovd_v3_genes AS g LEFT OUTER JOIN lovd_v3_users2genes AS u2g ON (g.id = u2g.geneid) LEFT OUTER JOIN lovd_v3_genes2diseases AS g2d ON (g.id = g2d.geneid) INNER JOIN lovd_v3_diseases AS d ON (g2d.diseaseid = d.id) WHERE u2g.show_order > 0 ORDER BY g.id
    Error : Mixing of GROUP columns (MIN(),MAX(),COUNT(),...) with no GROUP columns is illegal if there is no GROUP BY clause
- Links to other resources op gene viewEntry() moet opgeruimd worden; niet-actieve velden weg.
- Transcript create mag niet zonder genomic ref, want:
    Error: SOAP (Logged)
    /transcripts?create returned error in module 'getTranscriptsAndInfo'.
    Arguments :
            genomicReference = ""
            geneName = "DMD"
    SOAP response :
            senv:Server - string index out of range
    (met genomic ref hebben we dezelfde foutmelding)
- lovd_queryDB("SQL", true) fail for some reason (should be lovd_queryDB("SQL", array(), true) of course.
- Transcript aanmaken totaal onmogelijk op shared installatie (traag, server (apache?) loopt vast)
- (@Ivar) BUG: Gen selecteren met transcript aanmaken niet mogelijk; niet logisch gesorteerd
  * ViewList als oplossing? Page size klein houden?
- Geheugengebruik op shared install is absurd hoog (2 GB per Apache thread)
  * Memory leak in transcripts?create indien create niet wordt afgemaakt. Sowieso moet 't geheugengebruik van dit deel van 't script omlaag. Niet per se in alpha-01.
  * genes?create idem dito
  * transcripts/DMD?create moet blijven op transcripts/DMD?create (nu verliest hij de DMD in de URL)
  * Solution to mem_leak: max 5 work IDs van dezelfde action?
    - Datum als key binnen action's work array.
    - Ook te oude ID's opruimen?
  * Sowieso work ID weggooien na afronden actie.
  * Zelfde nodig met viewList data? Blijft ook hangen.
- Status page er uit of geheel anders (alleen totalen???)
- Ik heb het idee dat $bHalt in lovd_queryDB() veel vaker true dan false zou moeten zijn. Default op true zetten?
- Vanaf beta moeten bij bugfixes de datum en versie gezet worden.





MOET OVERLEGD WORDEN:
=====================
- Zwakkere koppeling tussen individu en disease?
  * Link IND2DIS: "proven"/"presumed" flag?
- Van alle overzichten moet bepaald worden wat de minimale level is die benodigd is.
- Als een viewList() gesorteerd wordt, moet de page terug naar 1?
- Submissie LOVD 1.1.0 vergeleken met 2.0, vergeleken met 3.0:
  * Hoe emails? Pas als klaar? Wat nou als niet klaar wordt opgegeven?
  * Wanneer opslaan?
- (BELANGRIJK) Allele => Gametic Phase? Check alle waardes in de groep.
- Menu's onder viewEntry's mooier maken: array met voorwaarde, link, logo en tekst. Functie doet de rest.
- Hoe kunnen we toch toestaan, dat users voor een grote groep genen tegelijk curator kunnen worden gemaakt?
  * Probleem vergeleken met LOVD 2.0 is dat je allow_edit en shown ook moet kunnen bewerken... Of kunnen we daar omheen werken?




Doen voordat LOVD 3.0 online gebruikt kan worden:
=================================================
- (Ivo) Stress test??? Als het datamodel écht moet worden aangepast, kan dat wellicht niet goed via inc-upgrade.php.
- (Ivo) Zie ik nu in het getekende model, dat variant toch niet zonder patient kan, omdat hij een screening moet hebben die een patient moet hebben???






Ook belangrijk, maar iets minder:
- Alle formulieren moeten fieldsets gaan gebruiken!!!
    Fieldsets die dicht zijn, moeten dicht blijven na submit. Idem voor open.
    Fieldsets die een error hebben én dicht staan, moeten gemarkeerd worden. CSS class geven die alleen activeert als hij dicht staat???
- (Ivar) Create gene:
  * Het werkelijk toevoegen van een VariantOnTranscript kolom in een functie???
  * Create genes moet in één transaction! Implement rollbacks if needed (LOVD already handles some)!
- (Ivar) Create disease: enable standard columns:
  * Het werkelijk toevoegen van een kolom in een functie???
  * Moet in één transaction? If so, implement rollbacks?
  * Sets kolommen activeren per data type? Andersom kan al wel; kolom toevoegen aan sets data types.
- Pathogenicity los koppelen, zodat "proof" kan worden toegevoegd, maar ook linken aan meerdere varianten.
- (Ivar) Aangezien /transcripts/DMD?create werkt, moet /transcripts/DMD ook werken.
- (Overleg I&I nodig) Disease -> trait? (eye color, etc)
  * Could we support both?
  * Probleem is dat je dan een speciale diseaseID nodig hebt met een flag = trait, of een flag in TABLE_SHARED_COLUMNS???
- Implement timeouts for Mutalyzer and other external sources? Try to reconnect to mirror? Ajax?
  * default_socket_timeout
  * but also: mysql.connect_timeout ?
- Security modes:
  * Passwords expire
  * Enter password in every page deactivated for some time?
  * Lock users after how many failed attempts?
  * Sessions last for how long?
  ...

Lifestyle columns? Smoker yes/no? Where/how to store?





Kán later, maar VOOR dat er externe gebruikers actief worden:
=============================================================
- Check_update.php heeft nog rare trucjes m.b.t. het tellen van de varianten.


- Denk uit hoe één data viewList() ingesteld kan worden; object_variants.php begint een zooitje te worden!!!
    Eerste argument kan ook een categorie zijn? VariantOnGenome, VariantAll, VariantIndividual, VariantScreeningIndividual, whatever???
- In commit #40 is er bij diseases viewEntry() van alles veranderd, maar het werkt niet goed (notices) en volgens mij is de query te uitgebreid. Ik moet hier later nog naar kijken.
- Nu searching werkt op kolommen die met HAVING zouden moeten worden doorzocht, pas dit toe in verschillende viewLists. Bijvoorbeeld users.


- Hoe slaan we functional effect op?
- Hoe slaan we pathogeniciteit op?

- Tabs instellen?




LOVD 3.0
====================
++++Check tijdens install of MultiViews / URL rewriting from .htaccess werkt. Drupal doet 't...
++++Tijdens install checken of autoextend aan staat? Anders kan InnoDB zonder ruimte komen te zitten.
        Dan meteen maar checken welke rechten de MySQL user heeft op de database.
    Both deadlocks and lock wait timeouts are normal on busy servers and it is necessary for applications to be aware that they may happen and handle them by retrying.
        You can make them less likely by doing as little work as possible between the first change to data during a transaction and the commit, so the locks are held
        for the shortest possible time and for the smallest possible number of rows. Sometimes splitting work between different transactions may be practical and helpful.
    When a transaction rollback occurs due to a deadlock or lock wait timeout, it cancels the effect of the statements within the transaction. But if the
        start-transaction statement was START TRANSACTION or BEGIN statement, rollback does not cancel that statement. Further SQL statements become part
        of the transaction until the occurrence of COMMIT, ROLLBACK, or some SQL statement that causes an implicit commit.
    Submission:
        1) Vul individual info in
        2) Phenotype info? Yes/No?
            If yes: Selecteer ziekte (pre-filled?) en vul phenotype in (formulieren anders per phenotype!)
        3) Detectie technieken invullen? Zo ja: geef per det. tech. aan welke genen (genlijst maken uit gegeven disease?) getest zijn), en aangeven of varianten gevonden zijn.
            (als men aangeeft dat er varianten waren, maar toen stopte, moeten ze later maar die koppeling weer aanleggen (verschil variantid = 0 / NULL om te helpen?))
                Of anders: misschien dan verplichten door te gaan?
        4) Varianten invullen: per gen is formulier anders, dus daarna per gen een variant invoeren, inclusief ind2var data? Of allele apart splitsen?
            Bij het invullen, aangeven door welke eerder ingevulde detection technieken hij gevonden is?
        Submissies over verschillende genen moet geen probleem meer zijn.
            Warning: multiple curators should be warned, then.
            Submit ombouwen; gen kiezen per variant die je toevoegt?
                Dan moet je in het overzicht van wat er gesubmit is, wel de variant lists per gen doen, zoals variant detailed view.
    WebService / Feed can be turned on or off? Explain there that turning it off can imply less traffic to their database.
        Mummi had een mooie quote die curators kan waarschuwen voor de effecten, als ze die uit zetten:
            You (and some curators) probably won't agree with me fully on the above, I'm sure. But there could still be a useful compromise to be made here: have an on/off switch for the WS/feed access methods so curators can disable these if they wish, but at the same time 'educate' them in what I argued above about data accessibility. They can then balance this against their desire to, for one reason or other, limit accessibility options to HTML only.
            NB The accessibility issue will become especially relevant in the future when we will have the various distributed search tools: curators need to be informed that if they disable the WS/feed access methods, their LSDB will not be included alongside with all the other datasources in the federation, and so they will be less visible to potential users, get less traffic, and (ultimately) fewer citations than they might otherwise receive, and overall less peer recognition at the end of the day.
    Columns hiden door Javascript -> instant hide. Kolommen een class mee geven daarvoor.
    History/revision control: misschien max 5 levels terug ofzo? Instellen ergens? Of een bepaalde tijd maar? Auto clean up?
    Raymond Dalgleish wil beta-tester zijn.
    Instelling: sta curatoren toe individualdata te wijzigen van individuals met mutaties ook in andere genen (dus nog steeds met minimaal 1 mutatie in eigen gen).
    Het hele HTML/XSS probleem. Nu hebben we nog overal XSS checks, behalve in de custom link script, toch? Deny HTML input voor column data?
        Het hele probleem is dat alle output moet ge-htmlspecialchar()ed worden om normaal getoond te worden als er een < in zit. Maar echte HTML gaat dan verloren.
        Toch overal maar htmlspecialchars invoeren? Dan moet bij de custom links worden uitgekeken dat het niet twee keer gebeurt, en daarnaast moeten de custom links later worden toegepast.
++++ListView: stick header to top met code die ook voor LOVD 2 was geschreven.
    Een array opbouwen van $_PATH_ELEMENTS / ACTIONS met titels waar we zijn geweest (edits, dels, creates e.d. niet opgeslagen) zodat je makkelijk terug kunt?
    Probeer iets in te bouwen, dat een upgrade te negeren is. Dat dus iemand kan zeggen; ik wil blijven werken, ik weet dat er een probleem is. Maak dan het scherm duidelijk anders. Continue bericht bovenaan o.i.d.?
        $_SESSION VAR, uitgelezen door inc-top.php.
    Revisie aanmaken ja/nee is een optie, ik hoef dan niet in de system settings te kiezen om dit aan of uit te zetten?
        Hmm... anders: die optie kan gebruikt worden om te FORCEN dat er ALTIJD een nieuwe revisie aan gehangen wordt. Je kunt zonder die optie er voor kiezen, maar als het aan staat is het gewoon altijd zo.
    Data license? Mummi schreef er over (Science Commons) 8 november 2009
        == Creative Commons, right? License chooser inbouwen per gen. Maar wat doen met de genomic variants?
    Implement tokens for forms that do not ask passwords? Tokens valid for 5 minutes only? Not to prevent abuse of computers left logged in, because the token will be regenerated, but against CSRF.
    Create disease: probeer te standaardiseren door data op te halen van OMIM of iets anders, zoals create gene ook basis data ophaalt.
    De inc-init moet toch een autocommit hebben? waarom staat dat niet aan?
    Mouseover (hover) over kolom namen op viewList() ? Waar stellen we dat in? Alleen met custom columns of ook met andere views? Idem in viewEntry?
    Laat de install checken op de aanwezigheid van bepaalde functies, zoals XML functies.
    Om het renderen van de pagina niet te laten wachten op het downloaden van JS includes, kan deze code gebruikt worden. Werkt (nu nog) alleen op nieuwere browsers; oudere wachten alsnog (dus wel backwards compatible).
        <script>
            var node = document.createElement('script');
            node.type = 'text/javascript';
            node.async = true;
            node.src = 'example.js';
            // Now insert the node into the DOM, perhaps using insertBefore()
        </script>
    Na het inloggen, indien er een update is, een tooltip weergeven rechtsonder dat er een update is! Niet de hele tijd dus, alleen nadat je net bent ingelogd.
        Je kunt $_STAT gewoon analyseren, want het icoon is al geladen tijdens het inloggen dus hoort al te weten dat er een update is!
        Popup heeft andere kleur aan de hand van update belangrijkheid...
        Kan popup zo'n hoekje hebben die naar het logo wijst?
    Kan de inc-upgrade intelligenter gemaakt worden zodat na een ALTER TABLE ADD COLUMN de foutmelding "Duplicate column name XXX" netjes wordt afgevangen?
    Fouten tijdens upgraden loggen, zodat na te zoeken is waar 't fout ging?
    Probleem LOVD2 c.0, c.= en c.? notaties. Speciale variant IDs of andere flag? Wel/niet tonen = instelling?
    Ondersteuning DOI i.p.v. PubMed? NMDB2 heeft al een DOI custom link.
    Genomische positie velden hernoemen naar hg19_* ?
    Na aanmaken gen, doorsturen naar welke kolommen toevoegen/verwijderen/sorteren
        Idem na disease
    Bij aanmaken disease, controleren of je die disease mogelijk al hebt? Behalve op OMIM ID natuurlijk?

KNOWN BUGS:
===========
The user lists viewEntry() and viewList() should know the difference between submitters, collaborators and curators.

Overdenkingen / Kleinere dingen om te doen:
===========================================
Screenings zijn gekoppeld aan VARIANTS. Maar als 1 variant op twee transcripten effect heeft, is wellicht maar 1 van die effecten gemeten!
    Via screenings2genes is wellicht te achterhalen wel gen het betrof, maar niet welk transcript!!!
During installation LOVD does not worry about an empty database URL. However, when editing the settings it does mention that this URL is empty. Make sure the install has this behaviour as well.
Voorstel schrijven voor nieuwe functies voor de Mutalyzer webservice, standaardisatie van de namen.
Tabs instelbaar: system settings bepaalt welke tabs worden getoond; genes, diseases, transcripts, users, individuals, etc.
    Misschien niet de system settings maar individueel? Extra tabje toevoegen die + heet, die de lijst mogelijke tabs geeft met een checkbox er voor? Gebruiker vinkt aan en uit, klikt Save en pagina herlaad?
        Beter nog: inc-top herlaad? Ajax daarvoor gebruiken?
Formulier voor toevoegen/edit kolom: onchange toevoegen aan kolom breedte veld voor dynamische update.
Een column ID moet altijd met een hoofdletter gemaakt worden, dus daar moet een controle op!
FINISH COLUMNS EDIT??? First think about how to do this???
    Display settings en global settings individual cols zijn in 2.0 gescheiden, dat heeft echt 0 nut en is verwarrend. Kappen, dus!
        Denk nog ff na of verschillende niveau's misschien verschillende dingen moeten kunnen editen, zo niet er gewoon 1 script van maken.
        Variants & phenotypes zijn dan dus speciaal. "Edit gene-specific display settings" / "Edit disease-specific display settings" of iets dergelijks.
        Dit al in 2.0 regelen? Zet dan op de global edit form bij de Variant cols: changes to *these* fields will not show on the gene's column display settings (whatever) unless you reset these columns to the new default settings.
ik moet nog eens kijken naar welke formulieren een password nodig hebben
TABLE_VARIANTS_ON_TRANSCRIPTS heeft nu alleen een valid_from om te linken naar TABLE_VARIANTS. Maar dat is niet enforced, dat die combi voorkomt in TABLE_VARIANTS.
    Hoe vaak zal de data in zowel TABLE_VARIANTS als TABLE_VARIANTS_ON_TRANSCRIPTS bewerkt worden??? Misschien moeten we het afhandelen als twee aparte entiteiten,
        en TABLE_VARIANTS_ON_TRANSCRIPTS alle versioning kolommen geven; de juiste variant wordt er dan bijgezocht op basis van alleen de ID.
    Kan TABLE_VARIANTS niet een AUTO_NUMBERING hebben?

Waar we echt mee bezig zijn:
============================
position_g_mrna_start en position_g_mrna_end (TABLE_TRANSCRIPTS), volgens mij moet dat simpeler.
checkFields() roept getForm() aan om te bepalen hoe de velden heten. Dus als er een error is, wordt getForm() twee keer aangeroepen.
    Voor forms met veel queries is dat een beetje vervelend. Kan getForm() niet een static variabele in gebruik nemen,
    die ziet dat het formulier al eerder gemaakt is (door de checkFields() call) en die dan direct returnen?
Col add: Er moet nog gekeken worden naar het bevestigingsbericht. Ook moeten diseases goed omschreven worden in messages; bij voorkeur met hun symbol.
Create genes moet het formulier gaan indelen in secties die geopend en gesloten kunnen worden.
Overnemen van LOVD2: view users zien in welke genen ze gesubmit hebben?
Store list_size per data type in a $_COOKIE, just like hidden columns and stuff
USER FORCE LOGOUT
USERS: stel tijdzone in?
    Maar dan moet je eerst even goed inlezen over die tijdzones, over de nieuwe functies en hoe dat goed te gebruiken...
Create gene: herstel percentages van voorgang, zodat het logischer verloopt.
Edit gene: created date kunnen veranderen???? Beetje vreemd, maar sowieso slikt hij de H:i:s niet die er achter staat.


// Lijst van questions about the future:
Tabs, volgorde goed?
    Submitters tab nu Users, ook zodat je db admin en managers kan zien?
        Voor de normale gebruikers moeten we bepaalde kolommen weghalen. En andere toevoegen? Adres staat niet genoemd. Zien de normale mensen de details ook (= doorklikken), of moeten we een nieuwe view maken?
Submenu's weg, knopjes met uitschuif met opties?
    Gebruik kleuren om te scheiden? Laat zien nu geen verschil zien tussen var + ind; maar straks nog meer categoriën!
        Hide set columns, unhide all columns = algemeen
    Vinkjes voor iedere entry om snel te curaten/deleten/booten/etc oid?
Suggesties:
    Includen van de Setup in de Configuration, de dropdown als alternatief voor het horizontale menu was een goed idee,
    submitters should be able to edit info to whichever individual, but edit only their own data,
    dropdown menu "tools" above variants is a good idea, right click on variant -> maybe left click on a small button or mouseover explaining to right-click?,
    show pathogenicity in color values for the whole line?, skip the download format - people can use the system to edit?, maybe check out the uniprot download format?,
        The uniprot format by the way has the advantage to use lines for the data, so adding more lines for a individual's phenotype data is just fine, but the file gets so long...
    mouseover column or column header for legend info?
CURRDB in cookie!



Wat moet ik onthouden tijdens het coden?
=========================================
* $_SERVER['PHP_SELF'] werkt niet meer! Want daar kan vanalles in staan. SCRIPT_NAME niet gebruiken voor doorsturen, omdat we geen .php in de URL willen.
    Af en toe ff zoeken, om te kijken of het stiekem toch gebruikt wordt.
* mysql_query() moeten omgezet worden
* mail() moeten omgezet worden
* column names have been changed for tables, or the order has been changed. setting names the same.
* Unique variant overview toont alleen DNA veld???
* SELECT COUNT(*) FROM t = slower on InnoDB (index scan needed). SHOW TABLE STATUS also can be used if an *approximate* row count is sufficient.
* TRUNCATE TABLE == DELETE FROM @ InnoDB. As of MySQL 4.1.13, truncate operations cause an implicit commit. Before 4.1.13, truncate operations are not transaction-safe; an error occurs when attempting one in the course of an active transaction.
    - Some older versions may not reset the AUTO_INCREMENT value. In this case, you can use ALTER TABLE tbl_name AUTO_INCREMENT=1  after the TRUNCATE TABLE statement.
* TABLE STRUCTURE:
    // References anders regelen?
    // Alleles -> Anders noemen? Splitsen?
    // Extra tabel met Gene -> Chromosoom, mapping NG/NC_slice -> NC (1 cijfer genoeg? of strand info?), exon structuur? Data wat nu in die txt table zit?
    // Allows for orphaned screening. BUT now also, one screening for multiple individuals. (??? still true ???)
* Add index op DNA!!! (if we know how to insert the DNA information into the db)
* User levels:
    Submitter
    Colaborator (kan SOMMIGE extra velden zien van publieke entries) -> extra niveau kolom publiek ja/nee, maar collaborators wel/nee (public, collaborators, private)?
    Curator
    Manager
    Database administrator
* Remove comments like "// 2009-12-34; 2.0-??; blabla
* Je hoeft links helemaal niet zo lang te maken, vanwege de BASE in de header.
* $_SESSION['currdb'] zou eigenlijk alleen maar moeten zijn, om te onthouden waar je ook al weer was. Verder hoeft dat ding helemaal niet getoond te worden bovenaan de pagina, tenzij je echt ín een gen zit... toch?
* lovd_dbFout -> lovd_queryError()


Not sure yet how to...
======================
- Custom Column database system online
- GPL 2 only? Of toch 3 houden? Of 3 only maken? ff checken...
- API HTTP status codes: http://gif.phpnet.org/frederic/programs/http_status_codes/
- Mutationcol nog wel nodig???
- Delete users: Delete optie gewoon weglaten, tenzij er geen children zijn?
- Variant listings
    Nu kunnen we zoeken op detection technique en disease, we moeten dat toch wel blijven tonen... of? Kunnen we met MySQL 4.1 technieken de laatste tonen? Extra queries te zwaar? Stored procedures?
- Consequence (RNA / AA changes) apart van DNA houden?
- Aanmaken disease - voorstellen cols dmv OMIM ID en ontology lookup?
- Bij het editen insluiten de modified_date van de entry. Als die, bij het editen van de data ineens anders is, moet je een foutmelding geven. Twee mensen hebben tegelijkertijd er aan gewerkt!
    Wellicht direct in de update query?
- All the traffic to variants and individuals in LOVD 2.0 enters through variants.php, lucky me. So this file in 3.0 will both serve the "new" clean URLs, but if it detects the old LOVD 2.0 formatted URLs, it will forward to the standard URL.
- If we let people pick an NM for a gene, how do we get to more information about this NM? Does NCBI provide this?
  * Have been looking into this. Can we make this shorter: http://www.ncbi.nlm.nih.gov/nuccore/?EntrezSystem2.PEntrez.DbConnector.LastQueryKey=1&EntrezSystem2.PEntrez.DbConnector.Cmd=file&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.sPresentation=docsum&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.FFormat=docsum&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.Db=nuccore&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.QueryKey=1&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.CurrFilter=all&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.ResultCount=1&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.Id=NM_004006.2&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.uid=238018044&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.FileFormat=docsum&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.LastPresentation=docsum&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.Presentation=docsum&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.PageSize=20&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.LastPageSize=20&EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_ResultsController.ResultCount=1&p%24a=EntrezSystem2.PEntrez.Nuccore.Sequence_ResultsPanel.Sequence_DisplayBar.SendToSubmit&p%24l=EntrezSystem2&p%24st=nuccore
  * Or use eUtils???
- Genen als HOXA@ en UGT1A zijn officieel een erkend gensymbool maar zijn families van genen; ze hebben een NG per groep genen, maar een NM per gen, en de Mutalyzer SOAP call flipt omdat die geen NC slice kan maken.


HANDLEIDING
===========
- Moet zo geschreven worden, dat er van dezelfde source een HTML en PDF gegenereerd kan worden.
- Per pagina moet duidelijk zijn, welk level nodig is om deze feature te gebruiken, en vanaf welke versie dit is ingevoerd.
- Vanuit LOVD moet de Help of Documentation tab direct verwijzen naar de pagina in de handleiding over het scherm waar de gebruiker op dat moment in zit.


Update process
==============
* ALLES IN UTF-8!!!
* Laat export in 2.0 maken, die data al omzet. De vragen voor het omzetten van de data, gebeuren DAAR.
* De export wordt gedownload, en moet daarna in 3.0 geladen worden. Of SQL file met MD5 check?
* Klaar, de 2.0 kan verwijderd worden indien gewenst.


Needed before release
=====================
    Als mensen submitten (wat voor data dan ook), controleren of data al eerder in database gevonden is? Of data bijna gelijk hier aan?
        Aangevraagd door Raymond, en hij acht dit zeer belangrijk.
    Later een OFFLINE_MODE inbouwen, die geen contact op neemt met remote servers, maar toestaat dat alles handmatig wordt gedaan.
        Dit moet een (tijdelijke?) instelling zijn, en overal lekker irritant aangegeven worden, zodat mensen het niet gebruiken om van de standaarden af te kunnen wijken.
    Hoe kunnen we multiple select velden duidelijker maken?
        Standaard mouseover met uitleg? Standaard notes er bij?
        Opsplitsen in twee boxen waar entries heen gesleept kunnen worden?
        Omzetten naar lijst checkboxes?
    Loop nog een keer goed door de authenticatie heen; wat moet het publiek kunnen zien en wat niet? staat dat goed ingesteld?
    Import: choose character set
        Macintosh input files werken niet goed; heeft http://nl2.php.net/manual/en/filesystem.configuration.php#ini.auto-detect-line-endings
        nodig... maar dat werkt pas vanaf 4.3.0... Toch proberen? Alleen laden met config_import.txt, denk ik.
        Testfile heb ik in mijn email, van David Bonthron (Wed, 18 Jun 2008 12:28:46 +0100).
    Astrid Out en Carli Tops zouden graag de mogelijkheid hebben om een overzicht te krijgen van individuals naar mutaties, i.e.
        in de database van GenX kunnen zoeken op (aanwezigheid van?) varianten in GenY.
    Zorg er voor dat je LOVD 2.0 urls kan ontvangen, backward compatible.
        variants.php?select_db=GENE&action=view&view=    of zoeken op DBID links.
    Check alle links nog een keer, of die goed zijn gelegd. Ik ben begonnen zonder dat helder te hebben.
    Default list_size moet onthouden worden in COOKIE, net zoals de hidden cols.
++++Check alle queries 'ns.
    Cols - check huidige omschrijvingen in DMD of shared LOVD install, wellicht anders nu.
        DB-ID column heet ID op het formulier.
+++ Kolommen verkeerd gemapped.
        Peter: Individual/Independent_Families en Individual/Isolated_Cases naar Variant (SDH only?).
        Johan: country/ethnicity kolommen van individual naar variant (Ind2Var!).
            Individual/Origin/Geographic, Individual/Origin/Ethnic, Individual/Origin/Population
                Ertussen dan maar? Wacht ff hoor... de speciale variant overview werkt alleen op de Individual cols...
            (...) veel naar gevraagd wordt (Variant_Amino_acid_SIFT, Variant_Amino_acid_PolyPhen, Variant_Amino_acid_AlignGVGD, DNA-reported).
            Er is verwarring en overlap over de onderwerpen Allele, Individual/Occurence, Individual/Mutation/Origin, Individual/Mutation/Origin_De_Novo.
                De Alelle kolom covert eigenlijk al de Inheritance.
                Daarom heb ik een alternatief aangemaakt, te weten;
                Variant_Origin
                Origin; family (other affecteds besides brother/sister), sporadic (no affected relatives besides brother/sister), consanguinity parents, de novo (sporadic but de novo origin variant unproven)
                Keuzes uit drop-down menu;
                    ? (unknown)
                    familial
                    sporadic
                    sporadic, consanguineous parents
                    sporadic, non-consanguineous parents
                    sporadic, consanguinity parents?
                    de novo, in individual
                    de novo, in mother
                    de novo, in mother (grandmaternal allele)
                    de novo, in mother (grandpaternal allele)
                    de novo, in father
                    de novo, in father (grandmaternal allele)
                    de novo, in father (grandpaternal allele)
        Origin, Origin_De_Novo, Occurence (Tony)
++  Store submission for later? Dan hoort een ingelogde gebruiker een grote melding te zien dat er stored submissions zijn, en hij hoort deze te kunnen bekijken.
    Import duidelijk anders doen. Overschrijven toestaan indien aangevinkt; scheelt veel tijd en een tijdelijk lege database.
        Dat moet dan ongelofelijk goed gecontroleerd worden!!!
        Store in session / DB in een col met serialized data?
    Techniek nodig om de database dicht te zetten, tijdens de update.
        Johan wil een installatie dicht kunnen gooien (behalve hem en de DBA ofzo?), om tijdelijk te voorkomen dat submitters iets editen.
    Column type wizard:
        Select: waarde i.p.v. yes (-- select --) or no.
    MySQL-type kan geen DATETIME zijn, dat wordt niet geaccepteerd.
    Gebruikers de external sources laten beheren?
    SET CHARACTER SET character_set_name (voor vaststellen communicatie MySQL <-> Client. MySQL versie?
        Hebben we niet nodig, omdat de communicatie niet uitmaakt? Als ik maar terugkrijg, wat ik er eerder in heb gestopt.
    Kunnen we bij de upgrade zien of een upgrade al gedaan is? Dat een foutmelding "duplicate key" ofzo ondervangen wordt, zodat ie doorgaat?
    Find & Replace:
        Allowing full regexp mode where you can build your own regular expression; submitting the form will first return
            all changes that will be made to the database, agreeing will actually perform the find & replace.
            This is related to the "asterisk wildcard" question of Raymond Dalgleish, April 2010.




OTHER:
    If family ID column present, report in unique variant overview how many entries in total AND how many families in total.
    1 import file voor varianten voor meerdere genen?
    Internationalization?
- Boven log entries een paar blokken plaatsen; per log eentje. JS er op, die search_name invult, en formulier submit.
  * Eventueel met highlight.
